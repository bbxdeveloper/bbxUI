<app-head-line msg="Felhasználók kezelése"></app-head-line>

<nb-card>
    <nb-card-body>
        <form>
            <table class="card-table-wrapper" [id]="usersTableId" [nbTreeGrid]="usersDataSrc" [trackBy]="trackRows" equalColumnsWidth
                (focusin)="focusOnTable(true)" (focusout)="focusOnTable(false)">

                <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns"></tr>
                <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns"></tr>

                <ng-container *ngFor="let it of colDefs; let colPos = index" [nbTreeGridColumnDef]="it.colKey">
                    <ng-container [ngSwitch]="it.type">

                        <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef [style.width]="it.colWidth">
                            {{it.label}}
                        </th>

                        <td [tabindex]="row.tabindex" class="td-focusable" nbTreeGridCell
                            *nbTreeGridCellDef="let row; let rowPos = index"
                            [class.table-cell-edited]="userTable.editedRowPos == rowPos && userTable.editedProperty == it.objectKey"
                            (keydown.escape)="userTable.handleGridEscape(row, rowPos, it.objectKey, colPos)"
                            (keydown)="userTable.handleGridMovement($event, row, rowPos, it.objectKey, colPos, true)"
                            (keydown.enter)="userTable.handleGridEnter(row, rowPos, it.objectKey, colPos, usersTableEditId)"
                            (keydown.delete)="userTable.handleGridDelete($event, row, rowPos, it.objectKey)"
                            [style.width]="it.colWidth" [style.text-align]="it.textAlign"
                            class="{{it.navMatrixCssClass}}">

                            <input *ngIf="userTable.isEditingCell(rowPos, it.objectKey)" autocomplete="off" nbInput
                                [type]="it.type" name="PRODUCT-EDIT" [(ngModel)]="row.data[it.objectKey]"
                                [id]="usersTableEditId" [mask]="it.mask" [patterns]="customMaskPatterns"
                                [dropSpecialCharacters]="false" [showMaskTyped]="true" class="input-table-cell"
                                [style.text-align]="it.textAlign" />

                            <div *ngIf="!userTable.isEditingCell(rowPos, it.objectKey)">
                                {{ row.data[it.objectKey] }}
                            </div>
                        </td>
                    </ng-container>
                </ng-container>
            </table>
        </form>
    </nb-card-body>
</nb-card>
