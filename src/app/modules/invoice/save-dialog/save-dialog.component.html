<nb-card class="modal-product-active">
    <nb-card-header class="modal-product-active-header">
        <span>Bizonylat mentése</span>
    </nb-card-header>
    <nb-card-body class="modal-product-active-body">
        <form *ngIf="!!sumForm" [formGroup]="sumForm" #formDirective="ngForm" id="invoiceSaveForm">
            <nb-form-field>
                <div class="bbx-fd-form-field-inner-div">
                    <label>Összes nettó:</label>
                    <input [inputMask]="numberInputMask" class="right" nbInput type="text" formControlName="invoiceNetAmount">
                </div>
            </nb-form-field>

            <div [class.bbx-fd-form-field-wrapper-div-row]="this.isDiscountVisible">
                <nb-form-field class="bbx-fd-form-field-50" (keydown.enter)="formNav.HandleFormEnter($event)" *ngIf="this.OutGoingDelivery">
                    <div class="bbx-fd-form-field-inner-div-2 bbx-fd-form-field-inner-div-first">
                        <label>Kedvezmény %:</label>
                        <input class="{{TileCssClass}} discount-input" nbInput type="text" formControlName='invoiceDiscountPercent'
                            required="true" [inputMask]="discountInputMask" [placeholder]="discountPercentInputPlaceHolder"
                            (click)="formNav.HandleFormFieldClick($event)" (focusout)="RefreshCalc()">
                    </div>
                </nb-form-field>

                <nb-form-field class="bbx-fd-form-field-50" (keydown.enter)="MoveToSaveButtons($event)" *ngIf="!this.OutGoingDelivery && this.isDiscountVisible">
                    <div class="bbx-fd-form-field-inner-div-2 bbx-fd-form-field-inner-div-first">
                        <label>Kedvezmény %:</label>
                        <input class="{{TileCssClass}} discount-input" nbInput type="text" formControlName='invoiceDiscountPercent'
                            required="true" [inputMask]="discountInputMask" [placeholder]="discountPercentInputPlaceHolder"
                            (click)="formNav.HandleFormFieldClick($event)" (focusout)="RefreshCalc()">
                    </div>
                </nb-form-field>

                <nb-form-field (keydown.enter)="MoveToSaveButtons($event)">
                    <div [ngClass]="!this.isDiscountVisible ? 'bbx-fd-form-field-inner-div': 'bbx-fd-form-field-inner-div-2'">
                        <label>Kedvezmény értéke:</label>
                        <input nbInput type="text" formControlName='invoiceDiscountValue'
                            required="true" [inputMask]="numberInputMask" [placeholder]="discountInputPlaceHolder"
                            (focusout)="RefreshCalc()" readonly>
                    </div>
                </nb-form-field>
            </div>

            <nb-form-field>
                <div class="bbx-fd-form-field-inner-div">
                    <label>Kedvezménnyel csökkentett nettó:</label>
                    <input [inputMask]="numberInputMask" class="right" nbInput type="text" formControlName="discountedInvoiceNetAmount">
                </div>
            </nb-form-field>

            <nb-form-field *ngFor="let item of vatRateCodes; let rowPos = index">
                <div class="bbx-fd-form-field-inner-div">
                    <label>Összes {{item.Id}} áfa:</label>
                    <input (focusout)="RefreshCalc()"
                     [inputMask]="numberInputMask" class="right" nbInput type="text" formControlName="{{'vatRateFormControl-' + rowPos}}">
                </div>
            </nb-form-field>

            <nb-form-field>
                <div class="bbx-fd-form-field-inner-div">
                    <label>Összes bruttó:</label>
                    <input [inputMask]="numberInputMask" class="right" nbInput type="text" formControlName="lineGrossAmount">
                </div>
            </nb-form-field>

            <nb-form-field>
                <div class="bbx-fd-form-field-inner-div">
                    <label>Termékek száma:</label>
                    <input nbInput type="text" formControlName="invoiceLinesCount">
                </div>
            </nb-form-field>

            <div class="bbx-fd-form-field-wrapper-div-row" *ngIf="this.OutGoingDelivery">
                <nb-form-field (keydown.enter)="formNav.HandleFormEnter($event)" class="bbx-fd-form-field-75">
                    <div class="bbx-fd-form-field-inner-div-2 bbx-fd-form-field-inner-div-first">
                        <label class="multicol-label-col-1">Munkaszám</label>

                        <input class="{{TileCssClass}} {{TileCssColClass}}" nbInput type="text" formControlName="workNumber"
                            [readonly]="isEditModeOff"
                            (click)="formNav.HandleFormFieldClick($event)">
                    </div>
                </nb-form-field>

                <div class="bbx-fd-form-field-inner-div-2 bbx-fd-form-field-30 checkbox-wrapper"
                    (keydown.enter)="MoveToSaveButtons($event)">
                    <label class="multicol-label-col-2">Ár felülvizsg.?</label>

                    <input class="bbx-fd-checkbox" class="{{TileCssClass}}" type="checkbox" formControlName="priceReview"
                        [readonly]="isEditModeOff" (click)="formNav.HandleFormFieldClick($event)">
                </div>
            </div>
        </form>
    </nb-card-body>
    <nb-card-footer class="modal-product-active-footer">
        <button nbButton (click)="close(true)" status="primary" tabindex="-1" id="confirm-dialog-button-yes">Igen</button>
        <button nbButton (click)="close(false)" status="danger" tabindex="-1" id="confirm-dialog-button-no">Nem</button>
    </nb-card-footer>
</nb-card>